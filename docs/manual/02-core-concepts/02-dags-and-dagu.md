# DAGs and Dagu

DAGs are YAML files generated by Arborist and executed by Dagu.

## DAG Generation

```bash
arborist spec dag-build 001-my-feature
```

Generates `.arborist/dagu/001-my-feature/`:
```
├── root.yaml          # Root DAG
├── T001-setup.yaml    # Task sub-DAGs
└── T002-core.yaml
```

## Root DAG

Root DAG orchestrates task execution:

```yaml
name: "001-my-feature"
schedule: "@once"

env:
  - ARBORIST_MANIFEST=001-my-feature.json

steps:
  - name: "T001-setup"
    command: "arborist task run T001 --spec 001-my-feature"
    dependencies: []

  - name: "T002-core"
    command: "arborist task run T002 --spec 001-my-feature"
    dependencies: ["T001-setup"]
```

See: [`src/agent_arborist/dag_builder.py`](../../src/agent_arborist/dag_builder.py)

## Sub-DAGs

Each task has a sub-DAG with steps:

```yaml
name: "T001-setup"
steps:
  - name: "pre-sync"
    command: "arborist task pre-sync T001"

  - name: "run"
    command: "arborist task run T001 --runner claude"

  - name: "commit"
    command: "arborist task commit T001"

  - name: "test"
    command: "arborist task run-test T001"

  - name: "post-merge"
    command: "arborist task post-merge T001"

  - name: "cleanup"
    command: "arborist task post-cleanup T001"
```

## Execution

```bash
# Run with Arborist
arborist dag run 001-my-feature

# Check status  
arborist dag status 001-my-feature

# Dagu web UI
dagu server
# Open http://localhost:8080
```

## Next Steps

- [Git and Worktrees](./03-git-and-worktrees.md) - Worktree isolation
- [AI Runners](./04-ai-runners.md) - Runner configuration
